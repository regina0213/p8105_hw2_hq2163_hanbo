---
title: "p8105_hw2_hq2163_hanbo"
author: "Hanbo Qiu"
date: "September 30, 2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

##Import and clean NYC Transit csv files
Import my first csv (NYC_Transit_Subway_Entrance_And_Exit_Data.csv) and clean it.

```{r}
nyc_sub  = read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line:entry, vending, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE)
  )
```

##Write a short paragraph about this dataset 

The original dataset contains variables related to subway station name, location and each entrance and exit for each subway station in NYC. I import the dataset, convert  column names to lower snake case, retain column including "line, station, name, station latitude/longitude, routes served, entry, vending, entrance type, and ADA compliance" and convert the entry variable from character to a logical variable.The dimension of the dataset is `r nrow(nyc_sub)`*`r ncol(nyc_sub)`. The data provided includes columns route1 to route10, which list all routes served by a station entrance/exit. This isn't a "tidy" format, and should be restructured accordingly.

##Answer questions using these data

```{r}
dist_stat = distinct(nyc_sub, line, station_name)
n_dist_stat = nrow(dist_stat)

dist_stat_ada = subset(nyc_sub, ada == TRUE, select = c(station_name, line))
n_stat_ada = n_distinct(dist_stat_ada)

dist_stat_vend = subset(nyc_sub, vending == "YES", select = c(line, station_name))
n_stat_vend = n_distinct(dist_stat_vend)
prop_stat_vend = (n_dist_stat-n_stat_vend)/n_dist_stat
```

There are `r n_dist_stat` distinct stations. Among them, `r n_stat_ada` are ADA compliant. The proportion of station entrances / exits without vending allow entrance is `r prop_stat_vend`.

##Reformat data
Reformat data using route number and route name. Caculate distinct stations serve the A train and number of distinct stations which serve A train is ADA compliant.

```{r}
nyc_route = gather(nyc_sub, key = route_number, value = route_name, route1: route11)
stat_a = subset(nyc_route,route_name == "A")
dist_stat_a = distinct(stat_a, line, station_name)
n_dist_stat_a = nrow(dist_stat_a)

stat_a_ada = subset(stat_a, ada == TRUE)
a_stat_ada = distinct(stat_a_ada, line, station_name)
n_a_stat_ada = nrow(a_stat_ada)
```

There are `r n_dist_stat_a` distinct stations serve the A train. Of the stations that serve the A train, ADA compliant is `r n_a_stat_ada`.